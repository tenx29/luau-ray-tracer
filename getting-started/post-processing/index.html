
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tenx29.github.io/luau-ray-tracer/getting-started/post-processing/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.7">
    
    
      
        <title>Post-processing - Luau Ray Tracer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9d5733d3.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#post-processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Luau Ray Tracer Documentation" class="md-header__button md-logo" aria-label="Luau Ray Tracer Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Luau Ray Tracer Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Post-processing
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tenx29/luau-ray-tracer/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tenx29/luau-ray-tracer
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Luau Ray Tracer Documentation" class="md-nav__button md-logo" aria-label="Luau Ray Tracer Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Luau Ray Tracer Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tenx29/luau-ray-tracer/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    tenx29/luau-ray-tracer
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-setup/" class="md-nav__link">
        Tutorial setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../first-render/" class="md-nav__link">
        Creating your first render
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../first-shader/" class="md-nav__link">
        Creating your first shader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sky-shaders/" class="md-nav__link">
        Sky shaders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../buffers/" class="md-nav__link">
        Buffers
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Post-processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Post-processing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#post-processing-shaders" class="md-nav__link">
    Post-processing shaders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-post-processing-shader" class="md-nav__link">
    Creating a post-processing shader
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-shading/" class="md-nav__link">
        Advanced shading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/render-pipeline/" class="md-nav__link">
        The Render Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ray-tracing-camera/" class="md-nav__link">
        Ray Tracing Camera
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ray-tracer/" class="md-nav__link">
        Ray Tracer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/traced-ray/" class="md-nav__link">
        Traced Ray
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/shader/" class="md-nav__link">
        Shader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/post-processing-shader/" class="md-nav__link">
        Post Processing Shader
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#post-processing-shaders" class="md-nav__link">
    Post-processing shaders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-post-processing-shader" class="md-nav__link">
    Creating a post-processing shader
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/tenx29/luau-ray-tracer/edit/master/docs/getting-started/post-processing.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="post-processing">Post-processing</h1>
<p>Post-processing is the act of transforming the initially generated output into a final output. In this case this means modifying the Color, Depth and Normal buffers as needed after the path tracing step has completed. Post-processing is not required for the ray tracer to work, but can be useful for creating interesting effects.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The post-processing step only runs after the path tracing step has completed. This means that individual path data is not available to post-processing shaders. Unlike path shaders, post-processing shaders have access to all pixels in every buffer at once.</p>
</div>
<p><br></p>
<h2 id="post-processing-shaders">Post-processing shaders</h2>
<p>Post-processing shaders are shaders that are run after the path tracing step has completed. They are run on every pixel in the scene, and can modify the Color, Depth and Normal buffers.</p>
<p><br></p>
<h2 id="creating-a-post-processing-shader">Creating a post-processing shader</h2>
<p>Let's create a shader that detects edges in the image based the shapes of the objects in the scene. We will be using depth-based edge detection, which isn't the most accurate method, but is simple to implement.</p>
<p>It is recommended that you create a new folder in the Luau Ray Tracer package called <code>postprocessing</code> and put your post-processing shaders in there. For the purposes of this tutorial, we'll be assuming you do that.</p>
<p><br></p>
<p>Start by creating a new ModuleScript called <code>EdgeDetection</code> in the <code>postprocessing</code> folder.</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- ModuleScript</span>

<span class="kd">local</span> <span class="n">PostProcessingShader</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">script</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">classes</span><span class="p">.</span><span class="n">PostProcessingShader</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">EdgeDetection</span> <span class="o">=</span> <span class="n">PostProcessingShader</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>
</code></pre></div>
<p><br></p>
<div class="admonition info">
<p class="admonition-title">How does depth-based edge detection work?</p>
<p>Depth-based edge detection works by comparing the depth of each pixel to the depths of the adjacent pixels. If the difference between the depths is greater than a threshold, the pixel is considered an edge.</p>
</div>
<p><br></p>
<p>Let's define the function of the shader.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">-- Depth difference threshold to detect edges.</span>
<span class="c1">-- If the depth difference between a pixel and its adjacent pixel is greater than this threshold, the pixel is considered an edge.</span>
<span class="kd">local</span> <span class="n">edgeThreshold</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">EdgeDetection</span><span class="p">.</span><span class="n">Function</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">Raytracer</span><span class="p">,</span> <span class="p">...)</span>
    <span class="c1">-- Loop through every pixel in the image.</span>
    <span class="kr">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">.</span><span class="n">X</span> <span class="kr">do</span>
        <span class="kr">for</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Y</span> <span class="kr">do</span>
            <span class="c1">-- Get the depth of the current pixel.</span>
            <span class="kd">local</span> <span class="n">CurrentDepth</span> <span class="o">=</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span><span class="p">.</span><span class="n">Depth</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

            <span class="c1">-- Collect all the adjacent pixels.</span>
            <span class="c1">-- The first argument is the pixel&#39;s position, the second is the size of the ray traced viewport.</span>
            <span class="c1">-- The third argument is the radius of the area to search for adjacent pixels.</span>
            <span class="kd">local</span> <span class="n">AdjacentPixels</span> <span class="o">=</span> <span class="n">EdgeDetection</span><span class="p">:</span><span class="n">GetAdjacentPixels</span><span class="p">(</span><span class="n">Vector2</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="kd">local</span> <span class="n">AdjacentDepth</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1">-- Get the depth value for each pixel position from the depth buffer</span>
            <span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">pixel</span> <span class="kr">in</span> <span class="n">AdjacentPixels</span> <span class="kr">do</span>
                <span class="nb">table.insert</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span><span class="p">.</span><span class="n">Depth</span><span class="p">[</span><span class="n">pixel</span><span class="p">.</span><span class="n">X</span><span class="p">][</span><span class="n">pixel</span><span class="p">.</span><span class="n">Y</span><span class="p">])</span>
            <span class="kr">end</span>

            <span class="c1">-- Sort the depths. We&#39;ll use this to find the minimum and maximum depths.</span>
            <span class="nb">table.sort</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">)</span>
            <span class="c1">-- Get the difference between the depths.</span>
            <span class="kd">local</span> <span class="n">DepthDifference</span> <span class="o">=</span> <span class="nb">math.abs</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">AdjacentDepth</span><span class="p">[</span><span class="o">#</span><span class="n">AdjacentDepth</span><span class="p">])</span>
            <span class="c1">-- If the difference is greater than a threshold, the pixel is an edge.</span>
            <span class="kr">if</span> <span class="n">DepthDifference</span> <span class="o">&gt;</span> <span class="n">edgeThreshold</span> <span class="kr">then</span>
                <span class="c1">-- Edges will be highlighted in red in the image.</span>
                <span class="c1">-- Note that SetPixel sets the color of the pixel, not the depth.</span>
                <span class="n">Raytracer</span><span class="p">:</span><span class="n">SetPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Color3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="kr">end</span>
        <span class="kr">end</span>
    <span class="kr">end</span>

    <span class="c1">-- Since we don&#39;t need to generate any more buffers, we can return the Ray Tracer&#39;s buffers in their current state.</span>
    <span class="c1">-- This has the same result as returning nil.</span>
    <span class="kr">return</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">EdgeDetection</span>
</code></pre></div>
</td></tr></table>
<p><br></p>
<details class="abstract">
<summary>The full EdgeDetection shader</summary>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1">-- ModuleScript</span>

<span class="kd">local</span> <span class="n">PostProcessingShader</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">script</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">Parent</span><span class="p">.</span><span class="n">classes</span><span class="p">.</span><span class="n">PostProcessingShader</span><span class="p">)</span>

<span class="kd">local</span> <span class="n">EdgeDetection</span> <span class="o">=</span> <span class="n">PostProcessingShader</span><span class="p">.</span><span class="n">new</span><span class="p">()</span>

<span class="c1">-- Depth difference threshold to detect edges.</span>
<span class="c1">-- If the depth difference between a pixel and its adjacent pixel is greater than this threshold, the pixel is considered an edge.</span>
<span class="kd">local</span> <span class="n">edgeThreshold</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">EdgeDetection</span><span class="p">.</span><span class="n">Function</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">Raytracer</span><span class="p">,</span> <span class="p">...)</span>
    <span class="c1">-- Loop through every pixel in the image.</span>
    <span class="kr">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">.</span><span class="n">X</span> <span class="kr">do</span>
        <span class="kr">for</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">.</span><span class="n">Y</span> <span class="kr">do</span>
            <span class="c1">-- Get the depth of the current pixel.</span>
            <span class="kd">local</span> <span class="n">CurrentDepth</span> <span class="o">=</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span><span class="p">.</span><span class="n">Depth</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

            <span class="c1">-- Collect all the adjacent pixels.</span>
            <span class="c1">-- The first argument is the pixel&#39;s position, the second is the size of the ray traced viewport.</span>
            <span class="c1">-- The third argument is the radius of the area to search for adjacent pixels.</span>
            <span class="kd">local</span> <span class="n">AdjacentPixels</span> <span class="o">=</span> <span class="n">EdgeDetection</span><span class="p">:</span><span class="n">GetAdjacentPixels</span><span class="p">(</span><span class="n">Vector2</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Camera</span><span class="p">.</span><span class="n">Resolution</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="kd">local</span> <span class="n">AdjacentDepth</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1">-- Get the depth value for each pixel position from the depth buffer</span>
            <span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">pixel</span> <span class="kr">in</span> <span class="n">AdjacentPixels</span> <span class="kr">do</span>
                <span class="nb">table.insert</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">,</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span><span class="p">.</span><span class="n">Depth</span><span class="p">[</span><span class="n">pixel</span><span class="p">.</span><span class="n">X</span><span class="p">][</span><span class="n">pixel</span><span class="p">.</span><span class="n">Y</span><span class="p">])</span>
            <span class="kr">end</span>

            <span class="c1">-- Sort the depths. We&#39;ll use this to find the minimum and maximum depths.</span>
            <span class="nb">table.sort</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">)</span>
            <span class="c1">-- Get the difference between the depths.</span>
            <span class="kd">local</span> <span class="n">DepthDifference</span> <span class="o">=</span> <span class="nb">math.abs</span><span class="p">(</span><span class="n">AdjacentDepth</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">AdjacentDepth</span><span class="p">[</span><span class="o">#</span><span class="n">AdjacentDepth</span><span class="p">])</span>
            <span class="c1">-- If the difference is greater than a threshold, the pixel is an edge.</span>
            <span class="kr">if</span> <span class="n">DepthDifference</span> <span class="o">&gt;</span> <span class="n">edgeThreshold</span> <span class="kr">then</span>
                <span class="c1">-- Edges will be highlighted in red in the image.</span>
                <span class="c1">-- Note that SetPixel sets the color of the pixel, not the depth.</span>
                <span class="n">Raytracer</span><span class="p">:</span><span class="n">SetPixel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Color3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="kr">end</span>
        <span class="kr">end</span>
    <span class="kr">end</span>

    <span class="c1">-- Since we don&#39;t need to generate any more buffers, we can return the Ray Tracer&#39;s buffers in their current state.</span>
    <span class="c1">-- This has the same result as returning nil.</span>
    <span class="kr">return</span> <span class="n">Raytracer</span><span class="p">.</span><span class="n">Buffers</span>
<span class="kr">end</span>

<span class="kr">return</span> <span class="n">EdgeDetection</span>
</code></pre></div>
</td></tr></table>
</details>
<p><br></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that the <code>Function</code> property of the shader is a function that takes the Ray Tracer as its first argument. This is passed automatically when calling <code>RayTracer:PostProcess()</code>. <code>...</code> is the rest of the arguments passed to the shader via the RayTracer:PostProcess method.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The shader function is responsible for selecting the appropriate pixels to modify. If you want to modify every pixel in the image, you can do so by looping through every pixel in the image, as seen in the code above.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The post-processing shaders are expected to return nothing or the Ray Tracer's buffers to be used for the next post-processing shader. If the shader returns <code>nil</code>, the Ray Tracer will continue to use its current buffers. Returning the buffers can be useful if you want to pass additional information to the next post-processing shader, as you can return more buffers than what the Ray Tracer has by default.</p>
</div>
<p><br></p>
<p>Now let's add the Edge Detection shader to our main script.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">EdgeDetection</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">postprocessing</span><span class="p">.</span><span class="n">EdgeDetection</span><span class="p">)</span>
</code></pre></div>
<p><br></p>
<p>And replace the previous RayTracer with the following:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">myRayTracer</span> <span class="o">=</span> <span class="n">RayTracer</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">myCamera</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="n">SkyShader</span><span class="p">,</span> <span class="n">TestShader</span><span class="p">},</span> <span class="p">{</span><span class="n">EdgeDetection</span><span class="p">})</span>
</code></pre></div>
<p>Just like the other shaders, post-processing shaders are passed to the Ray Tracer in a table and executed in order.</p>
<p><br></p>
<p>If we try rendering our scene again, we'll notice that nothing has changed. This is because post-processing shaders are not automatically executed when rendering a scene.</p>
<p>To execute the post-processing shaders, we can call the <code>RayTracer:PostProcess()</code> method after the initial render:
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">image</span> <span class="o">=</span> <span class="n">myRayTracer</span><span class="p">:</span><span class="n">Render</span><span class="p">()</span>
<span class="n">myRayTracer</span><span class="p">:</span><span class="n">PostProcess</span><span class="p">()</span>
</code></pre></div></p>
<details class="abstract">
<summary>The full script so far</summary>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">RayTracingCamera</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">classes</span><span class="p">.</span><span class="n">RayTracingCamera</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">RayTracer</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">classes</span><span class="p">.</span><span class="n">RayTracer</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">TestShader</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">shaders</span><span class="p">.</span><span class="n">TestShader</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">SkyShader</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">shaders</span><span class="p">.</span><span class="n">SkyShader</span><span class="p">)</span>
<span class="hll"><span class="kd">local</span> <span class="n">EdgeDetection</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="n">package</span><span class="p">.</span><span class="n">postprocessing</span><span class="p">.</span><span class="n">EdgeDetection</span><span class="p">)</span>
</span>
<span class="c1">-- We&#39;ll use a resolution of 100x100 to avoid having to wait too long for the render to complete.</span>
<span class="kd">local</span> <span class="n">resolution</span> <span class="o">=</span> <span class="n">Vector2</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">fieldOfView</span> <span class="o">=</span> <span class="nb">math.rad</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>    <span class="c1">-- Field of view is measured in radians.</span>
<span class="kd">local</span> <span class="n">farPlane</span> <span class="o">=</span> <span class="mi">100</span>                <span class="c1">-- How far the camera can see.</span>

<span class="c1">-- We&#39;ll place the camera 5 studs above the world origin.</span>
<span class="c1">-- Because we&#39;re not defining a direction, the camera will be looking down the -Z axis.</span>
<span class="kd">local</span> <span class="n">CFrame</span> <span class="o">=</span> <span class="n">CFrame</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1">-- Create the camera.</span>
<span class="kd">local</span> <span class="n">myCamera</span> <span class="o">=</span> <span class="n">RayTracingCamera</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">fieldOfView</span><span class="p">,</span> <span class="n">farPlane</span><span class="p">,</span> <span class="n">CFrame</span><span class="p">)</span>

<span class="c1">-- We won&#39;t be defining shaders just yet, so we don&#39;t need to pass any parameters except the camera.</span>
<span class="hll"><span class="kd">local</span> <span class="n">myRayTracer</span> <span class="o">=</span> <span class="n">RayTracer</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">myCamera</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="n">SkyShader</span><span class="p">,</span> <span class="n">TestShader</span><span class="p">},</span> <span class="p">{</span><span class="n">EdgeDetection</span><span class="p">})</span>
</span>
<span class="kd">local</span> <span class="n">image</span> <span class="o">=</span> <span class="n">myRayTracer</span><span class="p">:</span><span class="n">Render</span><span class="p">()</span>
<span class="hll"><span class="n">myRayTracer</span><span class="p">:</span><span class="n">PostProcess</span><span class="p">()</span>
</span>
<span class="kr">function</span> <span class="nf">showImage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="kr">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">image</span> <span class="kr">do</span>
        <span class="kr">for</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">image</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="kr">do</span>
            <span class="kd">local</span> <span class="n">pixel</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Part&quot;</span><span class="p">)</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Position</span> <span class="o">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">resolution</span><span class="p">.</span><span class="n">Y</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">resolution</span><span class="p">.</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="n">Vector3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">resolution</span><span class="p">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">resolution</span><span class="p">.</span><span class="n">Y</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Anchored</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">CanCollide</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">CanTouch</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">CanQuery</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">CastShadow</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Locked</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Material</span> <span class="o">=</span> <span class="n">Enum</span><span class="p">.</span><span class="n">Material</span><span class="p">.</span><span class="n">SmoothPlastic</span>
            <span class="n">pixel</span><span class="p">.</span><span class="n">Parent</span> <span class="o">=</span> <span class="n">workspace</span>
        <span class="kr">end</span>
    <span class="kr">end</span>
<span class="kr">end</span>

<span class="n">showImage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
</details>
<p><br></p>
<p>Now let's try rendering our scene again.</p>
<p><img alt="Image with edges highlighted" src="../../resources/edge-detection-result.png" /></p>
<p>That looks pretty good! Let's try adding some more parts to the scene.</p>
<p><img alt="Image with failed edge detection" src="../../resources/edge-detection-result2.png" /></p>
<p>Looks like the white block's edges are not detected. This is because in this particular example it's located close to the camera's far plane, resulting in the depth difference between the block and the camera to be too small for our shader to detect. In our shader we set 0.2 as the threshold, so an edge's minimum depth difference is 20% of the camera's far plane distance. In our main script we set the far plane to 100 studs, so the minimum depth difference is 0.2 * 100 = 20. Therefore, if the object is more than 80 studs away from the camera, it won't be detected as an edge.</p>
<p>Let's bring the block closer to the camera.</p>
<p><img alt="Image with successful edge detection" src="../../resources/edge-detection-result3.png" /></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../buffers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Buffers" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Buffers
            </div>
          </div>
        </a>
      
      
        
        <a href="../advanced-shading/" class="md-footer__link md-footer__link--next" aria-label="Next: Advanced shading" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Advanced shading
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.e87a5f81.min.js"></script>
      
    
  </body>
</html>